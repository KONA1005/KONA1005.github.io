---
title: " [SQL] SQL 조인에 관하여 "
date: 2022-05-03-04 
categories: SQL
---

## 조인의 종류

1. 내부 조인
2. 외부 조인
3. 동등 조인
4. 안티 조인
5. 셀프 조인
6. 세미 조인
7. 카타시안 조인
8. ANSI 조인

# 1. 내부 조인

### 1. 동등 조인

- 가장 기본
- WHERE 절에서 등호 연산자를 사용해 2개 이상의 테이블이나 뷰를 연결한 조인. **등호 연산자를 사용한 WHERE절 조건에 만족하는 데이터를 추출**
- WHERE절에 기술한 조건 = 조인조건

### (1) 조인조건

- 컬럼 단위로 기술
- 조인 조건 결과가 참에 해당하는, 두 컬럼 값이 같은 행을 추출

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled.png)

사원과 부서 테이블에 공통적으로 존재하는 department_id를 등호 연산자를 사용해 조회조건에 명시했다.

부서번호는 부서 테이블에서 키에 해당해 필수 값이지만 사원 테이블에서는 필수 값이 아니므로 쿼리 결과는 사원테이블에서 부서번호 컬럼 값이 있는 건만 추출된다.

- 사원 테이블의 전체 건수가 107건이지만 부서번호가 없는 사원이 한 건 존재하므로 106건이 조회된 것이다.

## 3. 세미조인

- IN / EXISTS
- 서브 쿼리에 있는 테이블 B / 메인 쿼리에 사용된 테이블 A
    - B테이블에 존재하는 A테이블의 데이터를 추출하는 조인

### (1) EXISTS

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%201.png)

WHERE절에 EXISTS 연산자를 사용하고 부서 테이블과의 조인 조건은 서브 쿼리에 명시하였다.

- 조건에 만족하는 데이터가 한 건이라도 있으면 결과 즉시 반환

### (2) IN

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%202.png)

서브 쿼리 내에 두 테이블의 조인 조건이 없다.

- IN 은 OR조건으로 변환 가능
- 이거나 저거나

## 4. 안티 조인

- 서브 쿼리의 B테이블에 없는 메인 쿼리의 A테이블의 데이터만 추출하는 조인 방법
- 세미조인과 반대 개념
- 한쪽 테이블에만 있는 데이터는 추출하는 것.
- NOT IN / NOT EXISTS

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%203.png)

- manager_id 값이 있는 부서에 속한 사원 테이블을 조회
- 매니저 아이디가 널값이 아닌 애들을 빼고
- departments b를 조인한 부분은 해당 사원에 대한 부서명을 가져오기 위한 조인, 안티 조인은 NOT IN 절 이하의 서브 쿼리에 명시

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%204.png)

- 사원 테이블에 부서번호가 NULL인 사원이 1명 존재 하기 때문에 106건이 아닌 107건이 조회

## 5. 셀프 조인

- 동일한 한 테이블을 사용해 조인

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%205.png)

사원 테이블을 A, B로 나누어 조인

같은 부서번호를 가진 사원 중 A 사원번호가 B사원번호보다 작은 건을 조회. 사원 테이블에서 부서번호가 20인 건은 단 2건 뿐, 1번 조건에 의해 결과는 1건만 추출된 점에 유의.

# 2. 외부조인

- 조인 조건에 만족하는 데이터 뿐만 아니라, 어느 한 쪽 테이블에 조인 조건에 명시된 컬럼에 값이 없거나(NULL 이더라도) 해당 행이 아예 없더라도 데이터를 모두 추출한다.

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%206.png)

10개가 아닌 31개의 결과가 조회되었다.

job_history에 없는 부서(10, 30, 40등)도 모두 조회되었다.

- **(+)** 표시
- 조인 조건에서 데이터가 없는 테이블의 열에 **(+)** 기호 붙이기

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%207.png)

- **외부 조인은 조건에 해당하는 조인 조건 모두에 (+)를 붙여야 함.**
- **조인 대상 테이블 중 데이터가 없는 테이블 조인 조건에 (+)를 붙인다.**
- **한 번에 한 테이블에만 외부 조인을 할 수 있다.**
- **(+)연산자가 붙은 조건과 OR을 같이 사용할 수 없다**
- **(+)연산자가 붙은 조건에는 IN 연산자를 같이 사용할 수 없다.( 단 IN절에 포함되는 값이 1개인 때는 사용 가능하다)**

# 3. 카타시안 조인

- 잘 안씀
- WHERE절에 조인 조건이 없는 조인
- FROM 절에 테이블 명시 했으나 두 테이블 간 조인 조건이 없는 조인이다.
- FROM절에 2개 이상 테이블을 명시했으므로 일종의 조인이다.
- A테이블 건수가 n1, B테이블 건수다 n2 = 결과는 n1 * n2

# 4. ANSI 조인

- ANSI SQL 문법을 사용한 조인
- 모든 조인을 ANSI문법으로 변환 가능
- 조인 조건이 WHERE절이 아닌 FROM 절에 들어간다.

## (1) ANSI 내부조인

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%208.png)

- ANSI 내부조인은 FROM절에서 **INNER JOIN** 구문을 쓴다.
- 조인 조건은 **ON**절에 명시
- 조인 조건 외의 조건 기존대로 WHERE절에 명시
    - 조인 조건 컬럼이 두 테이블 모두 동일하다?
        - ON → USING절 사용
            - 이때 SELECT절에서 조인 조건에 포함된 컬럼명을 테이블명, 컬럼명이 아닌 **컬럼명**만 기술해야 한다.

## (2) ANSI 외부조인

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%209.png)

- FROM절에 명시된 테이블 순서에 입각해 먼저 명시된 테이블을 기준으로 **LEFT, RIGHT**를 붙인다.
- OUTER 생략 가능
- LEFT / RIGHT 바꾸려면 테이블 순서 바꿔야 함

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%2010.png)

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%2011.png)

## (3) CROSS 조인

- WHERE절에 조인 조건을 명시 하지 않은 카타시안 조인의 ANSI문법

![Untitled](/images/2022-05-03-04_SQL_JOIN/Untitled%2012.png)